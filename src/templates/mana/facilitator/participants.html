{% extends "base.html" %}

{% block title %}Manage Participants Â· {{ assessment.title }}{% endblock %}

{% block content %}
<div class="bg-neutral-50 min-h-screen py-8">
    <div class="max-w-6xl mx-auto space-y-8">
        <header class="bg-white border border-gray-100 rounded-3xl shadow-sm p-8 space-y-2">
            <p class="text-sm uppercase tracking-wide text-gray-400">Participant Management</p>
            <h1 class="text-3xl font-bold text-gray-900">{{ assessment.title }}</h1>
            <p class="text-gray-600">Invite stakeholders across LGUs, NGAs, CSOs, and community leaders. Accounts created here receive sequential access to workshop forms.</p>
        </header>

        <section class="grid gap-6 lg:grid-cols-2">
            <div class="bg-white border border-gray-100 rounded-3xl shadow-sm p-6 space-y-4" data-task-id="{{ assessment.id }}">
                <h2 class="text-xl font-semibold text-gray-900">Add individual participant</h2>
                <form method="post" class="space-y-4">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="single">
                    <div class="grid gap-4 md:grid-cols-2">
                        {% include "components/form_field.html" with field=registration_form.email label="Email" placeholder="participant@example.com" %}
                        {% include "components/form_field.html" with field=registration_form.temp_password label="Temporary password" placeholder="Optional" %}
                    </div>
                    <div class="grid gap-4 md:grid-cols-2">
                        {% include "components/form_field.html" with field=registration_form.first_name label="First name" placeholder="Given name" %}
                        {% include "components/form_field.html" with field=registration_form.last_name label="Last name" placeholder="Family name" %}
                    </div>
                    <div class="grid gap-4 md:grid-cols-2">
                        {% include "components/form_field.html" with field=registration_form.stakeholder_type label="Stakeholder type" placeholder="Select stakeholder" %}
                        {% include "components/form_field.html" with field=registration_form.organization label="Organization" placeholder="Organization or group" %}
                    </div>
                    <div class="grid gap-4 md:grid-cols-3">
                        {% include "components/form_field.html" with field=registration_form.province label="Province" placeholder="Select province" %}
                        {% include "components/form_field.html" with field=registration_form.municipality label="Municipality" placeholder="Optional" %}
                        {% include "components/form_field.html" with field=registration_form.barangay label="Barangay" placeholder="Optional" %}
                    </div>
                    <button type="submit" class="btn-primary px-5 py-3 rounded-xl text-white font-semibold shadow">Create participant</button>
                </form>
            </div>
            <div class="bg-white border border-gray-100 rounded-3xl shadow-sm p-6 space-y-4" data-task-id="{{ assessment.id }}">
                <h2 class="text-xl font-semibold text-gray-900">Bulk import (CSV)</h2>
                <p class="text-sm text-gray-500">Upload a CSV with columns: email, first_name, last_name, stakeholder_type, organization, province_id, municipality_id, barangay_id, password (optional).</p>
                <form method="post" enctype="multipart/form-data" class="space-y-4">
                    {% csrf_token %}
                    <input type="hidden" name="form_type" value="bulk">
                    {{ bulk_form.csv_file }}
                    <button type="submit" class="inline-flex items-center gap-2 px-5 py-3 border border-gray-200 rounded-xl text-sm text-gray-600 hover:bg-gray-100">
                        <i class="fas fa-upload"></i>
                        Import CSV
                    </button>
                </form>
            </div>
        </section>

        <section>
            {% include "mana/facilitator/partials/participants_card.html" %}
        </section>
    </div>
</div>
{% endblock %}
