{# Task Board Quick Actions - FAB Pattern #}
{# Include this at the bottom of staff_task_board.html, before {% endblock %} #}

{% load static %}

<!-- Floating Quick Actions Menu -->
<div class="fixed bottom-6 right-6 z-50" x-data="{ open: false }">
    <!-- Main FAB Button -->
    <button
        @click="open = !open"
        type="button"
        class="w-16 h-16 bg-gradient-to-br from-emerald-600 to-teal-600 text-white rounded-full shadow-2xl hover:shadow-emerald-500/50 hover:scale-110 active:scale-95 transition-all duration-300 flex items-center justify-center group relative"
        aria-label="Quick Actions Menu"
        aria-expanded="false"
        x-bind:aria-expanded="open.toString()"
    >
        <i class="fas fa-bolt text-2xl transition-transform duration-300"
           :class="open ? 'rotate-180' : 'rotate-0'"></i>
        <span class="absolute -top-1 -right-1 w-5 h-5 bg-rose-500 text-white text-xs font-bold rounded-full flex items-center justify-center" x-show="!open" x-transition>
            4
        </span>
    </button>

    <!-- Action Menu -->
    <div
        x-show="open"
        @click.away="open = false"
        x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 scale-90 translate-y-4"
        x-transition:enter-end="opacity-100 scale-100 translate-y-0"
        x-transition:leave="transition ease-in duration-150"
        x-transition:leave-start="opacity-100 scale-100 translate-y-0"
        x-transition:leave-end="opacity-0 scale-90 translate-y-4"
        class="absolute bottom-20 right-0 w-72 bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden"
        style="display: none;"
    >
        <div class="bg-gradient-to-r from-emerald-600 to-teal-600 px-5 py-4">
            <h3 class="text-sm font-bold text-white uppercase tracking-wide flex items-center gap-2">
                <i class="fas fa-bolt"></i>
                Quick Actions
            </h3>
        </div>
        <div class="py-2">
            <!-- Quick Filters Toggle -->
            <button
                type="button"
                class="w-full px-5 py-3 flex items-center gap-3 hover:bg-blue-50 transition-colors text-left group"
                onclick="document.querySelector('.bg-white.rounded-xl.shadow-xl.border.border-gray-200.mb-8').scrollIntoView({ behavior: 'smooth', block: 'center' });"
            >
                <div class="w-12 h-12 rounded-xl flex items-center justify-center bg-blue-100 text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-all duration-200">
                    <i class="fas fa-filter text-base"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-semibold text-gray-900">Quick Filters</p>
                    <p class="text-xs text-gray-500">Jump to filters section</p>
                </div>
                <i class="fas fa-chevron-right text-gray-400 text-xs group-hover:translate-x-1 transition-transform"></i>
            </button>

            <!-- Bulk Operations -->
            <button
                type="button"
                class="w-full px-5 py-3 flex items-center gap-3 hover:bg-purple-50 transition-colors text-left group"
                onclick="alert('Bulk operations: Select multiple tasks using checkboxes (feature coming soon)');"
            >
                <div class="w-12 h-12 rounded-xl flex items-center justify-center bg-purple-100 text-purple-600 group-hover:bg-purple-600 group-hover:text-white transition-all duration-200">
                    <i class="fas fa-tasks text-base"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-semibold text-gray-900">Bulk Operations</p>
                    <p class="text-xs text-gray-500">Update multiple tasks</p>
                </div>
                <i class="fas fa-chevron-right text-gray-400 text-xs group-hover:translate-x-1 transition-transform"></i>
            </button>

            <!-- Export Tasks -->
            <button
                type="button"
                class="w-full px-5 py-3 flex items-center gap-3 hover:bg-emerald-50 transition-colors text-left group"
                onclick="window.location.href='{% url 'common:work_item_list' %}?export=csv';"
            >
                <div class="w-12 h-12 rounded-xl flex items-center justify-center bg-emerald-100 text-emerald-600 group-hover:bg-emerald-600 group-hover:text-white transition-all duration-200">
                    <i class="fas fa-download text-base"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-semibold text-gray-900">Export Tasks</p>
                    <p class="text-xs text-gray-500">Download as CSV</p>
                </div>
                <i class="fas fa-chevron-right text-gray-400 text-xs group-hover:translate-x-1 transition-transform"></i>
            </button>

            <!-- View Analytics -->
            <button
                type="button"
                class="w-full px-5 py-3 flex items-center gap-3 hover:bg-amber-50 transition-colors text-left group"
                onclick="window.location.href='{% url 'common:staff_management' %}';"
            >
                <div class="w-12 h-12 rounded-xl flex items-center justify-center bg-amber-100 text-amber-600 group-hover:bg-amber-600 group-hover:text-white transition-all duration-200">
                    <i class="fas fa-chart-line text-base"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-semibold text-gray-900">View Analytics</p>
                    <p class="text-xs text-gray-500">Task performance metrics</p>
                </div>
                <i class="fas fa-chevron-right text-gray-400 text-xs group-hover:translate-x-1 transition-transform"></i>
            </button>
        </div>
        <div class="border-t border-gray-200 px-5 py-3 bg-gray-50">
            <p class="text-xs text-gray-500 text-center">Press <kbd class="px-1.5 py-0.5 bg-white border border-gray-300 rounded text-xs font-mono">ESC</kbd> to close</p>
        </div>
    </div>
</div>

<!-- Keyboard Shortcut Handler -->
<script>
document.addEventListener('keydown', function(e) {
    // Close FAB menu on ESC
    if (e.key === 'Escape') {
        const fabMenu = document.querySelector('[x-data*="open"]');
        if (fabMenu && fabMenu.__x) {
            fabMenu.__x.$data.open = false;
        }
    }
});
</script>
