{% load static %}

<!-- Clarification Dialog for OBCMS Chat -->
<div class="flex gap-3 mb-4" id="clarification-{{ clarification_id }}">
    <!-- AI Assistant Icon -->
    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-teal-500 rounded-full flex items-center justify-center flex-shrink-0">
        <i class="fas fa-robot text-white text-sm"></i>
    </div>

    <!-- Clarification Content -->
    <div class="flex-1">
        <div class="bg-white rounded-lg rounded-tl-none p-4 shadow-sm border border-blue-200">

            <!-- Question -->
            <div class="mb-3">
                <p class="text-sm font-medium text-gray-800 mb-1">
                    <i class="fas fa-question-circle text-blue-500 mr-2"></i>
                    {{ message }}
                </p>
                <p class="text-xs text-gray-500">
                    Original query: <span class="italic">"{{ original_query }}"</span>
                </p>
            </div>

            <!-- Options -->
            <div class="space-y-2">
                {% for option in options %}
                <button
                    type="button"
                    class="w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-all group text-left"
                    hx-post="{% url 'common:chat_clarification_response' %}"
                    hx-vals='{"session_id": "{{ session_id }}", "issue_type": "{{ issue_type }}", "value": "{{ option.value }}", "original_query": "{{ original_query }}"}'
                    hx-target="#clarification-{{ clarification_id }}"
                    hx-swap="outerHTML swap:300ms"
                    hx-indicator="#clarification-loading-{{ clarification_id }}"
                    onclick="this.disabled=true">

                    <!-- Icon -->
                    <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-blue-100 to-teal-100 flex items-center justify-center flex-shrink-0 group-hover:from-blue-200 group-hover:to-teal-200 transition-colors">
                        <i class="fas fa-{{ option.icon }} text-blue-600"></i>
                    </div>

                    <!-- Label -->
                    <div class="flex-1">
                        <span class="text-sm font-medium text-gray-800 group-hover:text-blue-700">
                            {{ option.label }}
                        </span>
                    </div>

                    <!-- Arrow -->
                    <div class="text-gray-400 group-hover:text-blue-600 transition-colors">
                        <i class="fas fa-arrow-right text-sm"></i>
                    </div>
                </button>
                {% endfor %}
            </div>

            <!-- Loading Indicator -->
            <div id="clarification-loading-{{ clarification_id }}" class="htmx-indicator mt-3">
                <div class="flex items-center gap-2 text-sm text-blue-600">
                    <div class="flex gap-1">
                        <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 0ms"></span>
                        <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 150ms"></span>
                        <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 300ms"></span>
                    </div>
                    <span>Processing your choice...</span>
                </div>
            </div>

            <!-- Priority Badge (Optional) -->
            {% if priority == 'high' %}
            <div class="mt-3 pt-3 border-t border-gray-100">
                <span class="inline-flex items-center text-xs px-2 py-1 bg-amber-50 text-amber-700 rounded-full border border-amber-200">
                    <i class="fas fa-exclamation-circle mr-1.5"></i>
                    This information is required to proceed
                </span>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- Alternative: Compact Button List (Mobile-friendly) -->
{% comment %}
Uncomment this section if you prefer a more compact, mobile-friendly layout

<div class="flex gap-3 mb-4" id="clarification-{{ clarification_id }}">
    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-teal-500 rounded-full flex items-center justify-center flex-shrink-0">
        <i class="fas fa-robot text-white text-sm"></i>
    </div>

    <div class="flex-1">
        <div class="bg-white rounded-lg rounded-tl-none p-3 shadow-sm border border-blue-200">

            <p class="text-sm font-medium text-gray-800 mb-3">
                <i class="fas fa-question-circle text-blue-500 mr-2"></i>
                {{ message }}
            </p>

            <div class="flex flex-wrap gap-2">
                {% for option in options %}
                <button
                    type="button"
                    class="px-4 py-2 rounded-lg border border-gray-200 hover:border-blue-500 hover:bg-blue-50 text-sm font-medium text-gray-700 hover:text-blue-700 transition-all"
                    hx-post="{% url 'common:chat_clarification_response' %}"
                    hx-vals='{"session_id": "{{ session_id }}", "issue_type": "{{ issue_type }}", "value": "{{ option.value }}", "original_query": "{{ original_query }}"}'
                    hx-target="#clarification-{{ clarification_id }}"
                    hx-swap="outerHTML swap:300ms"
                    hx-indicator="#clarification-loading-{{ clarification_id }}"
                    onclick="this.disabled=true">
                    <i class="fas fa-{{ option.icon }} mr-1.5"></i>
                    {{ option.label }}
                </button>
                {% endfor %}
            </div>

            <div id="clarification-loading-{{ clarification_id }}" class="htmx-indicator mt-2">
                <div class="flex gap-1">
                    <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce"></span>
                    <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 150ms"></span>
                    <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 300ms"></span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endcomment %}

<!-- Alternative: Dropdown Select (For many options) -->
{% comment %}
Use this layout when there are more than 5 options

<div class="flex gap-3 mb-4" id="clarification-{{ clarification_id }}">
    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-teal-500 rounded-full flex items-center justify-center flex-shrink-0">
        <i class="fas fa-robot text-white text-sm"></i>
    </div>

    <div class="flex-1">
        <div class="bg-white rounded-lg rounded-tl-none p-4 shadow-sm border border-blue-200">

            <p class="text-sm font-medium text-gray-800 mb-3">
                <i class="fas fa-question-circle text-blue-500 mr-2"></i>
                {{ message }}
            </p>

            <form
                hx-post="{% url 'common:chat_clarification_response' %}"
                hx-target="#clarification-{{ clarification_id }}"
                hx-swap="outerHTML swap:300ms"
                hx-indicator="#clarification-loading-{{ clarification_id }}">

                {% csrf_token %}
                <input type="hidden" name="session_id" value="{{ session_id }}">
                <input type="hidden" name="issue_type" value="{{ issue_type }}">
                <input type="hidden" name="original_query" value="{{ original_query }}">

                <div class="space-y-2">
                    <div class="relative">
                        <select
                            name="value"
                            required
                            class="block w-full py-2.5 px-4 text-sm rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none pr-10 bg-white">
                            <option value="">-- Select an option --</option>
                            {% for option in options %}
                            <option value="{{ option.value }}">{{ option.label }}</option>
                            {% endfor %}
                        </select>
                        <span class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
                            <i class="fas fa-chevron-down text-gray-400 text-xs"></i>
                        </span>
                    </div>

                    <button
                        type="submit"
                        class="w-full px-4 py-2 bg-gradient-to-r from-blue-600 to-teal-600 text-white rounded-lg hover:shadow-lg transition-all text-sm font-medium">
                        <i class="fas fa-check mr-2"></i>
                        Confirm Selection
                    </button>
                </div>

                <div id="clarification-loading-{{ clarification_id }}" class="htmx-indicator mt-2">
                    <div class="flex items-center gap-2 text-sm text-blue-600">
                        <div class="flex gap-1">
                            <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce"></span>
                            <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 150ms"></span>
                            <span class="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style="animation-delay: 300ms"></span>
                        </div>
                        <span>Processing...</span>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endcomment %}
