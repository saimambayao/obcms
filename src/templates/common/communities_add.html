{% extends 'base.html' %}

{% block title %}Add New Community - OBC Management System{% endblock %}

{% block breadcrumb %}
<li class="flex items-center space-x-2">
    <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
    <a href="{% url 'common:communities_home' %}" class="text-gray-600 hover:text-gray-900">OBC Communities</a>
</li>
<li class="flex items-center space-x-2">
    <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
    <span class="text-gray-900 font-medium">Add New Community</span>
</li>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Add New Community</h1>
        <p class="mt-2 text-lg text-gray-600">
            Register a new OBC community in the system with comprehensive demographic, socio-economic, and cultural data.
        </p>
    </div>

    <!-- Form Card with Modern Styling -->
    <div class="bg-white rounded-xl shadow-xl border border-gray-200 mb-8">
        <div class="p-6 lg:p-8">
            <div class="flex items-center mb-6">
                <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-file-alt text-white text-xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">Community Registration Form</h2>
            </div>
            
            <!-- Tab Navigation -->
            <div class="border-b border-gray-200 mb-6">
                <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                    <button type="button" onclick="showTab('identification')" id="identification-tab" class="tab-button border-b-2 border-blue-500 py-2 px-1 text-sm font-medium text-blue-600">
                        <i class="fas fa-id-card mr-2"></i>Identification & Location
                    </button>
                    <button type="button" onclick="showTab('demographics')" id="demographics-tab" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-users mr-2"></i>Demographics
                    </button>
                    <button type="button" onclick="showTab('services')" id="services-tab" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-hand-holding-heart mr-2"></i>Basic Services
                    </button>
                    <button type="button" onclick="showTab('socioeconomic')" id="socioeconomic-tab" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-chart-line mr-2"></i>Socio-Economic
                    </button>
                    <button type="button" onclick="showTab('religious')" id="religious-tab" class="tab-button border-b-2 border-transparent py-2 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        <i class="fas fa-mosque mr-2"></i>Religious Facilities
                    </button>
                </nav>
            </div>
            
            <form method="post" class="space-y-6">
                {% csrf_token %}
                
                <!-- Form Errors -->
                {% if form.errors %}
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-exclamation-circle text-red-400"></i>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-red-800">There were errors with your submission</h3>
                            <div class="mt-2 text-sm text-red-700">
                                <ul class="list-disc pl-5 space-y-1">
                                    {% for field in form %}
                                        {% if field.errors %}
                                            {% for error in field.errors %}
                                                <li>{{ field.label }}: {{ error }}</li>
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                                    {% for error in form.non_field_errors %}
                                        <li>{{ error }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <!-- Tab Content -->
                <div class="tab-content">
                    <!-- Identification & Location Tab -->
                    <div id="identification-content" class="tab-pane">
                        <div class="bg-gray-50 rounded-lg p-6 space-y-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Identification & Location Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- OBC ID -->
                            <div>
                                <label for="{{ form.obc_id.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.obc_id.label }}
                                </label>
                                <input type="text" 
                                       name="{{ form.obc_id.name }}" 
                                       id="{{ form.obc_id.id_for_label }}"
                                       value="{{ form.obc_id.value|default_if_none:'' }}"
                                       placeholder="e.g., R12-SK-PAL-001"
                                       class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                {% if form.obc_id.errors %}
                                    <p class="mt-1 text-sm text-red-600">{{ form.obc_id.errors.0 }}</p>
                                {% endif %}
                            </div>
                            
                            <!-- Barangay -->
                            <div>
                                <label for="{{ form.barangay.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.barangay.label }} <span class="text-red-500">*</span>
                                </label>
                                <select name="{{ form.barangay.name }}" 
                                        id="{{ form.barangay.id_for_label }}"
                                        required
                                        class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                    <option value="">Select a barangay...</option>
                                    {% for barangay in form.barangay.field.queryset %}
                                        <option value="{{ barangay.id }}" {% if barangay.id|stringformat:"s" == form.barangay.value|stringformat:"s" %}selected{% endif %}>
                                            {{ barangay.name }} - {{ barangay.municipality.name }}, {{ barangay.municipality.province.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                                {% if form.barangay.errors %}
                                    <p class="mt-1 text-sm text-red-600">{{ form.barangay.errors.0 }}</p>
                                {% endif %}
                            </div>
                            
                            <!-- Community Names -->
                            <div class="md:col-span-2">
                                <label for="{{ form.community_names.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.community_names.label }}
                                </label>
                                <input type="text" 
                                       name="{{ form.community_names.name }}" 
                                       id="{{ form.community_names.id_for_label }}"
                                       value="{{ form.community_names.value|default_if_none:'' }}"
                                       placeholder="Common name(s) used for the community"
                                       class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                {% if form.community_names.errors %}
                                    <p class="mt-1 text-sm text-red-600">{{ form.community_names.errors.0 }}</p>
                                {% endif %}
                            </div>
                            
                            <!-- Source Document Reference -->
                            <div class="md:col-span-2">
                                <label for="{{ form.source_document_reference.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.source_document_reference.label }}
                                </label>
                                <textarea name="{{ form.source_document_reference.name }}" 
                                          id="{{ form.source_document_reference.id_for_label }}"
                                          rows="2"
                                          placeholder="e.g., OBC MANA Region 12, p.7"
                                          class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">{{ form.source_document_reference.value|default_if_none:'' }}</textarea>
                            </div>
                            
                            <!-- Location Details -->
                            <div>
                                <label for="{{ form.purok_sitio.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.purok_sitio.label }}
                                </label>
                                <input type="text" 
                                       name="{{ form.purok_sitio.name }}" 
                                       id="{{ form.purok_sitio.id_for_label }}"
                                       value="{{ form.purok_sitio.value|default_if_none:'' }}"
                                       placeholder="Specific Purok/Sitio"
                                       class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            </div>
                            
                            <div>
                                <label for="{{ form.specific_location.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.specific_location.label }}
                                </label>
                                <input type="text" 
                                       name="{{ form.specific_location.name }}" 
                                       id="{{ form.specific_location.id_for_label }}"
                                       value="{{ form.specific_location.value|default_if_none:'' }}"
                                       placeholder="Additional location details"
                                       class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            </div>
                            
                            <!-- Settlement Type & Proximity -->
                            <div>
                                <label for="{{ form.settlement_type.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.settlement_type.label }}
                                </label>
                                <select name="{{ form.settlement_type.name }}" 
                                        id="{{ form.settlement_type.id_for_label }}"
                                        class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                    {% for value, label in form.settlement_type.field.choices %}
                                        <option value="{{ value }}" {% if value == form.settlement_type.value %}selected{% endif %}>{{ label }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div>
                                <label for="{{ form.proximity_to_barmm.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.proximity_to_barmm.label }}
                                </label>
                                <select name="{{ form.proximity_to_barmm.name }}" 
                                        id="{{ form.proximity_to_barmm.id_for_label }}"
                                        class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                    <option value="">Select proximity...</option>
                                    {% for value, label in form.proximity_to_barmm.field.choices %}
                                        <option value="{{ value }}" {% if value == form.proximity_to_barmm.value %}selected{% endif %}>{{ label }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <!-- Geographic Coordinates -->
                            <div>
                                <label for="{{ form.latitude.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.latitude.label }}
                                </label>
                                <input type="number" 
                                       name="{{ form.latitude.name }}" 
                                       id="{{ form.latitude.id_for_label }}"
                                       value="{{ form.latitude.value|default_if_none:'' }}"
                                       step="any"
                                       placeholder="e.g., 6.5000"
                                       class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            </div>
                            
                            <div>
                                <label for="{{ form.longitude.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.longitude.label }}
                                </label>
                                <input type="number" 
                                       name="{{ form.longitude.name }}" 
                                       id="{{ form.longitude.id_for_label }}"
                                       value="{{ form.longitude.value|default_if_none:'' }}"
                                       step="any"
                                       placeholder="e.g., 124.5000"
                                       class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            </div>
                        </div>
                    </div>
                </div>
                    
                    <!-- Demographics Tab -->
                    <div id="demographics-content" class="tab-pane hidden">
                        <div class="bg-gray-50 rounded-lg p-6 space-y-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Demographic Profile</h3>
                            
                            <!-- Population Statistics -->
                            <h4 class="text-md font-medium text-gray-800 mb-3">Population Statistics</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                                <!-- Population -->
                                <div>
                                    <label for="{{ form.estimated_obc_population.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.estimated_obc_population.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.estimated_obc_population.name }}" 
                                           id="{{ form.estimated_obc_population.id_for_label }}"
                                           value="{{ form.estimated_obc_population.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.total_barangay_population.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.total_barangay_population.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.total_barangay_population.name }}" 
                                           id="{{ form.total_barangay_population.id_for_label }}"
                                           value="{{ form.total_barangay_population.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <!-- Households -->
                                <div>
                                    <label for="{{ form.households.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.households.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.households.name }}" 
                                           id="{{ form.households.id_for_label }}"
                                           value="{{ form.households.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <!-- Families -->
                                <div>
                                    <label for="{{ form.families.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.families.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.families.name }}" 
                                           id="{{ form.families.id_for_label }}"
                                           value="{{ form.families.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <!-- Age Demographics -->
                            <h4 class="text-md font-medium text-gray-800 mb-3">Age Demographics</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                                <div>
                                    <label for="{{ form.children_0_12.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        Children (0-12)
                                    </label>
                                    <input type="number" 
                                           name="{{ form.children_0_12.name }}" 
                                           id="{{ form.children_0_12.id_for_label }}"
                                           value="{{ form.children_0_12.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.youth_13_30.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        Youth (13-30)
                                    </label>
                                    <input type="number" 
                                           name="{{ form.youth_13_30.name }}" 
                                           id="{{ form.youth_13_30.id_for_label }}"
                                           value="{{ form.youth_13_30.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.adults_31_59.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        Adults (31-59)
                                    </label>
                                    <input type="number" 
                                           name="{{ form.adults_31_59.name }}" 
                                           id="{{ form.adults_31_59.id_for_label }}"
                                           value="{{ form.adults_31_59.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.seniors_60_plus.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        Seniors (60+)
                                    </label>
                                    <input type="number" 
                                           name="{{ form.seniors_60_plus.name }}" 
                                           id="{{ form.seniors_60_plus.id_for_label }}"
                                           value="{{ form.seniors_60_plus.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <!-- Ethnolinguistic Information -->
                            <h4 class="text-md font-medium text-gray-800 mb-3">Ethnolinguistic Profile</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="{{ form.primary_ethnolinguistic_group.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.primary_ethnolinguistic_group.label }}
                                    </label>
                                    <select name="{{ form.primary_ethnolinguistic_group.name }}" 
                                            id="{{ form.primary_ethnolinguistic_group.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select group...</option>
                                        {% for value, label in form.primary_ethnolinguistic_group.field.choices %}
                                            <option value="{{ value }}" {% if value == form.primary_ethnolinguistic_group.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.other_ethnolinguistic_groups.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.other_ethnolinguistic_groups.label }}
                                    </label>
                                    <input type="text" 
                                           name="{{ form.other_ethnolinguistic_groups.name }}" 
                                           id="{{ form.other_ethnolinguistic_groups.id_for_label }}"
                                           value="{{ form.other_ethnolinguistic_groups.value|default_if_none:'' }}"
                                           placeholder="Other groups (comma-separated)"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div class="md:col-span-2">
                                    <label for="{{ form.languages_spoken.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.languages_spoken.label }}
                                    </label>
                                    <input type="text" 
                                           name="{{ form.languages_spoken.name }}" 
                                           id="{{ form.languages_spoken.id_for_label }}"
                                           value="{{ form.languages_spoken.value|default_if_none:'' }}"
                                           placeholder="Languages spoken (comma-separated)"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <!-- Vulnerable Sectors -->
                            <h4 class="text-md font-medium text-gray-800 mb-3">Vulnerable Sectors Count</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <div>
                                    <label for="{{ form.women_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.women_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.women_count.name }}" 
                                           id="{{ form.women_count.id_for_label }}"
                                           value="{{ form.women_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.solo_parents_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.solo_parents_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.solo_parents_count.name }}" 
                                           id="{{ form.solo_parents_count.id_for_label }}"
                                           value="{{ form.solo_parents_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.elderly_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.elderly_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.elderly_count.name }}" 
                                           id="{{ form.elderly_count.id_for_label }}"
                                           value="{{ form.elderly_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.pwd_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.pwd_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.pwd_count.name }}" 
                                           id="{{ form.pwd_count.id_for_label }}"
                                           value="{{ form.pwd_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.farmers_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.farmers_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.farmers_count.name }}" 
                                           id="{{ form.farmers_count.id_for_label }}"
                                           value="{{ form.farmers_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.fisherfolk_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.fisherfolk_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.fisherfolk_count.name }}" 
                                           id="{{ form.fisherfolk_count.id_for_label }}"
                                           value="{{ form.fisherfolk_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.indigenous_peoples_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.indigenous_peoples_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.indigenous_peoples_count.name }}" 
                                           id="{{ form.indigenous_peoples_count.id_for_label }}"
                                           value="{{ form.indigenous_peoples_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.idps_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.idps_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.idps_count.name }}" 
                                           id="{{ form.idps_count.id_for_label }}"
                                           value="{{ form.idps_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.religious_leaders_ulama_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.religious_leaders_ulama_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.religious_leaders_ulama_count.name }}" 
                                           id="{{ form.religious_leaders_ulama_count.id_for_label }}"
                                           value="{{ form.religious_leaders_ulama_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.csos_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.csos_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.csos_count.name }}" 
                                           id="{{ form.csos_count.id_for_label }}"
                                           value="{{ form.csos_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.associations_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.associations_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.associations_count.name }}" 
                                           id="{{ form.associations_count.id_for_label }}"
                                           value="{{ form.associations_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.teachers_asatidz_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.teachers_asatidz_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.teachers_asatidz_count.name }}" 
                                           id="{{ form.teachers_asatidz_count.id_for_label }}"
                                           value="{{ form.teachers_asatidz_count.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Socio-Economic Tab -->
                    <div id="socioeconomic-content" class="tab-pane hidden">
                        <div class="bg-gray-50 rounded-lg p-6 space-y-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Socio-Economic Profile</h3>
                            
                            <!-- Livelihoods -->
                            <div>
                                <label for="{{ form.primary_livelihoods.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.primary_livelihoods.label }}
                                </label>
                                <textarea name="{{ form.primary_livelihoods.name }}" 
                                          id="{{ form.primary_livelihoods.id_for_label }}"
                                          rows="3"
                                          placeholder="e.g., Rice Farming, Coconut Production, Fishing"
                                          class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">{{ form.primary_livelihoods.value|default_if_none:'' }}</textarea>
                            </div>
                            
                            <div>
                                <label for="{{ form.secondary_livelihoods.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.secondary_livelihoods.label }}
                                </label>
                                <textarea name="{{ form.secondary_livelihoods.name }}" 
                                          id="{{ form.secondary_livelihoods.id_for_label }}"
                                          rows="3"
                                          class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">{{ form.secondary_livelihoods.value|default_if_none:'' }}</textarea>
                            </div>
                            
                            <!-- Economic Status -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="{{ form.estimated_poverty_incidence.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.estimated_poverty_incidence.label }}
                                    </label>
                                    <select name="{{ form.estimated_poverty_incidence.name }}" 
                                            id="{{ form.estimated_poverty_incidence.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select incidence level...</option>
                                        {% for value, label in form.estimated_poverty_incidence.field.choices %}
                                            <option value="{{ value }}" {% if value == form.estimated_poverty_incidence.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.development_status.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.development_status.label }}
                                    </label>
                                    <select name="{{ form.development_status.name }}" 
                                            id="{{ form.development_status.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        {% for value, label in form.development_status.field.choices %}
                                            <option value="{{ value }}" {% if value == form.development_status.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Economic Information -->
                            <h4 class="text-md font-medium text-gray-800 mb-3">Employment and Financial Access</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label for="{{ form.number_of_employed_obc.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.number_of_employed_obc.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.number_of_employed_obc.name }}" 
                                           id="{{ form.number_of_employed_obc.id_for_label }}"
                                           value="{{ form.number_of_employed_obc.value|default_if_none:'' }}"
                                           min="0"
                                           placeholder="Number of employed OBC individuals"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.number_of_unbanked_obc.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.number_of_unbanked_obc.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.number_of_unbanked_obc.name }}" 
                                           id="{{ form.number_of_unbanked_obc.id_for_label }}"
                                           value="{{ form.number_of_unbanked_obc.value|default_if_none:'' }}"
                                           min="0"
                                           placeholder="Number of unbanked OBC individuals"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <!-- Business and Enterprises -->
                            <h4 class="text-md font-medium text-gray-800 mb-3">Business and Enterprise Count</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                                <div>
                                    <label for="{{ form.number_of_cooperatives.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.number_of_cooperatives.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.number_of_cooperatives.name }}" 
                                           id="{{ form.number_of_cooperatives.id_for_label }}"
                                           value="{{ form.number_of_cooperatives.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.number_of_social_enterprises.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.number_of_social_enterprises.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.number_of_social_enterprises.name }}" 
                                           id="{{ form.number_of_social_enterprises.id_for_label }}"
                                           value="{{ form.number_of_social_enterprises.value|default_if_none:'' }}"
                                           min="0"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                                
                                <div>
                                    <label for="{{ form.number_of_micro_enterprises.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.number_of_micro_enterprises.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.number_of_micro_enterprises.name }}" 
                                           id="{{ form.number_of_micro_enterprises.id_for_label }}"
                                           value="{{ form.number_of_micro_enterprises.value|default_if_none:'' }}"
                                           min="0"
                                           placeholder="e.g., Sari-Sari Stores"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <!-- Land and Other Issues -->
                            <div>
                                <label for="{{ form.land_tenure_issues.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.land_tenure_issues.label }}
                                </label>
                                <textarea name="{{ form.land_tenure_issues.name }}" 
                                          id="{{ form.land_tenure_issues.id_for_label }}"
                                          rows="3"
                                          placeholder="Land tenure issues, disputes, ancestral domain claims"
                                          class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">{{ form.land_tenure_issues.value|default_if_none:'' }}</textarea>
                            </div>
                            
                            <div>
                                <label for="{{ form.financial_literacy_access.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                    {{ form.financial_literacy_access.label }}
                                </label>
                                <textarea name="{{ form.financial_literacy_access.name }}" 
                                          id="{{ form.financial_literacy_access.id_for_label }}"
                                          rows="3"
                                          placeholder="Financial literacy and access to financial services"
                                          class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">{{ form.financial_literacy_access.value|default_if_none:'' }}</textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Basic Services Tab -->
                    <div id="services-content" class="tab-pane hidden">
                        <div class="bg-gray-50 rounded-lg p-6 space-y-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Access to Basic Services</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <!-- Education Access -->
                                <div>
                                    <label for="{{ form.access_formal_education.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_formal_education.label }}
                                    </label>
                                    <select name="{{ form.access_formal_education.name }}" 
                                            id="{{ form.access_formal_education.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_formal_education.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_formal_education.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.access_als.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_als.label }}
                                    </label>
                                    <select name="{{ form.access_als.name }}" 
                                            id="{{ form.access_als.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_als.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_als.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.access_madrasah.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_madrasah.label }}
                                    </label>
                                    <select name="{{ form.access_madrasah.name }}" 
                                            id="{{ form.access_madrasah.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_madrasah.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_madrasah.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <!-- Healthcare & Basic Needs -->
                                <div>
                                    <label for="{{ form.access_healthcare.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_healthcare.label }}
                                    </label>
                                    <select name="{{ form.access_healthcare.name }}" 
                                            id="{{ form.access_healthcare.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_healthcare.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_healthcare.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.access_clean_water.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_clean_water.label }}
                                    </label>
                                    <select name="{{ form.access_clean_water.name }}" 
                                            id="{{ form.access_clean_water.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_clean_water.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_clean_water.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.access_sanitation.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        Access to Sanitation (Waste Management - presence of garbage collectors, MRFs, Sanitary Landfills)
                                    </label>
                                    <select name="{{ form.access_sanitation.name }}" 
                                            id="{{ form.access_sanitation.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_sanitation.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_sanitation.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <!-- Infrastructure -->
                                <div>
                                    <label for="{{ form.access_electricity.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_electricity.label }}
                                    </label>
                                    <select name="{{ form.access_electricity.name }}" 
                                            id="{{ form.access_electricity.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_electricity.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_electricity.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.access_roads_transport.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_roads_transport.label }}
                                    </label>
                                    <select name="{{ form.access_roads_transport.name }}" 
                                            id="{{ form.access_roads_transport.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_roads_transport.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_roads_transport.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="{{ form.access_communication.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.access_communication.label }}
                                    </label>
                                    <select name="{{ form.access_communication.name }}" 
                                            id="{{ form.access_communication.id_for_label }}"
                                            class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                        <option value="">Select access level...</option>
                                        {% for value, label in form.access_communication.field.choices %}
                                            <option value="{{ value }}" {% if value == form.access_communication.value %}selected{% endif %}>{{ label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Religious Facilities Tab -->
                    <div id="religious-content" class="tab-pane hidden">
                        <div class="bg-gray-50 rounded-lg p-6 space-y-6">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">Religious Facilities</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="flex items-center">
                                    <input type="checkbox" 
                                           name="{{ form.has_mosque.name }}" 
                                           id="{{ form.has_mosque.id_for_label }}"
                                           value="on"
                                           {% if form.has_mosque.value %}checked{% endif %}
                                           class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="{{ form.has_mosque.id_for_label }}" class="ml-2 block text-sm text-gray-700">
                                        {{ form.has_mosque.label }}
                                    </label>
                                </div>
                                
                                <div class="flex items-center">
                                    <input type="checkbox" 
                                           name="{{ form.has_madrasah.name }}" 
                                           id="{{ form.has_madrasah.id_for_label }}"
                                           value="on"
                                           {% if form.has_madrasah.value %}checked{% endif %}
                                           class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="{{ form.has_madrasah.id_for_label }}" class="ml-2 block text-sm text-gray-700">
                                        {{ form.has_madrasah.label }}
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mt-6">
                                <div>
                                    <label for="{{ form.religious_leaders_count.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-2">
                                        {{ form.religious_leaders_count.label }}
                                    </label>
                                    <input type="number" 
                                           name="{{ form.religious_leaders_count.name }}" 
                                           id="{{ form.religious_leaders_count.id_for_label }}"
                                           value="{{ form.religious_leaders_count.value|default_if_none:'' }}"
                                           min="0"
                                           placeholder="Number of religious leaders"
                                           class="block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                </div>
                            </div>
                            
                            <div class="mt-6">
                                <div class="flex items-center">
                                    <input type="checkbox" 
                                           name="{{ form.is_active.name }}" 
                                           id="{{ form.is_active.id_for_label }}"
                                           value="on"
                                           {% if form.is_active.value is not None %}{% if form.is_active.value %}checked{% endif %}{% else %}checked{% endif %}
                                           class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="{{ form.is_active.id_for_label }}" class="ml-2 block text-sm text-gray-700">
                                        {{ form.is_active.label }}
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Form Actions -->
                <div class="bg-white border-t border-gray-200 px-6 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2 text-sm text-gray-600">
                            <i class="fas fa-info-circle"></i>
                            <span>All fields marked with <span class="text-red-500">*</span> are required</span>
                        </div>
                        <div class="flex items-center space-x-4">
                            <button type="button" 
                                    onclick="saveDraft()"
                                    class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-200">
                                <i class="fas fa-save mr-2"></i>
                                Save Draft
                            </button>
                            <a href="{% url 'common:communities_manage' %}" 
                               class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-all duration-200">
                                <i class="fas fa-times mr-2"></i>
                                Cancel
                            </a>
                            <button type="submit" 
                                    class="inline-flex items-center px-6 py-3 border border-transparent text-sm font-medium rounded-lg shadow-sm text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transform hover:-translate-y-0.5 transition-all duration-200">
                                <i class="fas fa-check mr-2"></i>
                                Save & Submit
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Quick Actions Section -->
    <div class="bg-white rounded-xl shadow-xl border border-gray-200 mb-8">
        <div class="p-6">
            <div class="flex items-center mb-6">
                <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-bolt text-white text-xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">Quick Actions</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Import from Excel -->
                <button onclick="showImportModal()" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200 text-left group">
                    <div class="flex items-center mb-2">
                        <i class="fas fa-file-excel text-green-600 text-xl mr-3"></i>
                        <h3 class="font-semibold text-gray-900">Import from Excel</h3>
                    </div>
                    <p class="text-sm text-gray-600">Bulk import community data from Excel spreadsheet</p>
                </button>
                
                <!-- Download Template -->
                <a href="#" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200 text-left group">
                    <div class="flex items-center mb-2">
                        <i class="fas fa-download text-blue-600 text-xl mr-3"></i>
                        <h3 class="font-semibold text-gray-900">Download Template</h3>
                    </div>
                    <p class="text-sm text-gray-600">Get the Excel template for bulk import</p>
                </a>
                
                <!-- Auto-fill from Previous -->
                <button onclick="autoFillFromPrevious()" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200 text-left group">
                    <div class="flex items-center mb-2">
                        <i class="fas fa-magic text-purple-600 text-xl mr-3"></i>
                        <h3 class="font-semibold text-gray-900">Auto-fill Similar</h3>
                    </div>
                    <p class="text-sm text-gray-600">Pre-fill from similar community in same municipality</p>
                </button>
                
                <!-- View Guidelines -->
                <button onclick="showGuidelines()" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200 text-left group">
                    <div class="flex items-center mb-2">
                        <i class="fas fa-book text-orange-600 text-xl mr-3"></i>
                        <h3 class="font-semibold text-gray-900">Data Guidelines</h3>
                    </div>
                    <p class="text-sm text-gray-600">View data collection standards and guidelines</p>
                </button>
            </div>
        </div>
    </div>

    {% if recent_communities %}
    <!-- Recent Communities Section -->
    <div class="bg-white rounded-xl shadow-xl border border-gray-200 hover:shadow-2xl transition-shadow duration-300">
        <div class="p-6 lg:p-8">
            <div class="flex items-center mb-6">
                <div class="w-12 h-12 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-lg flex items-center justify-center mr-4">
                    <i class="fas fa-clock text-white text-xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-900">Recently Added Communities</h2>
            </div>
            
            <div class="overflow-hidden rounded-lg border border-gray-200">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
                            <tr>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    <div class="flex items-center">
                                        <i class="fas fa-home mr-2 text-gray-500"></i>
                                        Barangay
                                    </div>
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    <div class="flex items-center">
                                        <i class="fas fa-city mr-2 text-gray-500"></i>
                                        Municipality
                                    </div>
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    <div class="flex items-center">
                                        <i class="fas fa-map-marker-alt mr-2 text-gray-500"></i>
                                        Province
                                    </div>
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    <div class="flex items-center">
                                        <i class="fas fa-globe mr-2 text-gray-500"></i>
                                        Region
                                    </div>
                                </th>
                                <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                                    <div class="flex items-center">
                                        <i class="fas fa-calendar mr-2 text-gray-500"></i>
                                        Added
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% for community in recent_communities %}
                            <tr class="hover:bg-gray-50 transition-colors duration-200">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mr-3">
                                            <span class="text-white font-bold text-sm">{{ community.barangay.name|first|upper }}</span>
                                        </div>
                                        <div class="text-sm font-medium text-gray-900">{{ community.barangay.name }}</div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                                    {{ community.barangay.municipality.name }}
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                                    {{ community.barangay.municipality.province.name }}
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                        {{ community.barangay.municipality.province.region.name }}
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    <div class="flex items-center">
                                        <i class="fas fa-clock mr-2 text-gray-400"></i>
                                        {{ community.created_at|date:"M d, Y" }}
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="mt-6 flex justify-center">
                <a href="{% url 'common:communities_manage' %}" 
                   class="inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors duration-200">
                    View All Communities
                    <i class="fas fa-arrow-right ml-2 transform group-hover:translate-x-1 transition-transform"></i>
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<!-- JavaScript for Tab Functionality and Quick Actions -->
<script>
// Tab functionality
function showTab(tabId) {
    // Hide all tab panes
    document.querySelectorAll('.tab-pane').forEach(pane => {
        pane.classList.add('hidden');
    });
    
    // Remove active state from all tab buttons
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('border-blue-500', 'text-blue-600');
        button.classList.add('border-transparent', 'text-gray-500');
    });
    
    // Show selected tab pane
    document.getElementById(tabId + '-content').classList.remove('hidden');
    
    // Add active state to selected tab button
    const activeButton = document.getElementById(tabId + '-tab');
    activeButton.classList.remove('border-transparent', 'text-gray-500');
    activeButton.classList.add('border-blue-500', 'text-blue-600');
    
    // Save current tab to localStorage
    localStorage.setItem('currentOBCTab', tabId);
}

// Initialize tabs on page load
document.addEventListener('DOMContentLoaded', function() {
    // Restore last active tab or default to identification
    const lastTab = localStorage.getItem('currentOBCTab') || 'identification';
    showTab(lastTab);
});

// Quick Actions Functions
function saveDraft() {
    // Save form data to localStorage
    const formData = new FormData(document.querySelector('form'));
    const data = {};
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    localStorage.setItem('obcDraftData', JSON.stringify(data));
    
    // Show success message
    alert('Draft saved successfully! Your data will be restored when you return.');
}

function showImportModal() {
    // This would open a modal for Excel import
    alert('Excel import feature coming soon! This will allow you to bulk import community data from spreadsheets.');
}

function autoFillFromPrevious() {
    // This would fetch data from similar communities
    const barangaySelect = document.querySelector('select[name="barangay"]');
    if (!barangaySelect.value) {
        alert('Please select a barangay first to find similar communities.');
        return;
    }
    
    alert('Auto-fill feature coming soon! This will suggest data based on similar communities in the same area.');
}

function showGuidelines() {
    // This would show data collection guidelines
    window.open('/docs/obc-data-collection-guidelines', '_blank');
}

// Auto-save draft every 5 minutes
setInterval(function() {
    if (document.querySelector('form').checkValidity()) {
        saveDraft();
    }
}, 300000); // 5 minutes

// Restore draft data if available
document.addEventListener('DOMContentLoaded', function() {
    const draftData = localStorage.getItem('obcDraftData');
    if (draftData) {
        const data = JSON.parse(draftData);
        const restoreConfirm = confirm('A draft was found. Would you like to restore your previous work?');
        
        if (restoreConfirm) {
            // Restore form data
            Object.keys(data).forEach(key => {
                const field = document.querySelector(`[name="${key}"]`);
                if (field) {
                    if (field.type === 'checkbox') {
                        field.checked = data[key] === 'on';
                    } else {
                        field.value = data[key];
                    }
                }
            });
        }
    }
});

// Form validation helper
function validateTab(tabId) {
    const tabContent = document.getElementById(tabId + '-content');
    const requiredFields = tabContent.querySelectorAll('[required]');
    let isValid = true;
    
    requiredFields.forEach(field => {
        if (!field.value) {
            isValid = false;
            field.classList.add('border-red-500');
        } else {
            field.classList.remove('border-red-500');
        }
    });
    
    return isValid;
}

// Progress indicator
function updateProgress() {
    const form = document.querySelector('form');
    const totalFields = form.querySelectorAll('input, select, textarea').length;
    const filledFields = Array.from(form.querySelectorAll('input, select, textarea')).filter(field => {
        if (field.type === 'checkbox') return field.checked;
        return field.value;
    }).length;
    
    const progress = Math.round((filledFields / totalFields) * 100);
    console.log(`Form completion: ${progress}%`);
    
    // You can add a progress bar UI element here
}

// Update progress on input change
document.addEventListener('input', updateProgress);
document.addEventListener('change', updateProgress);
</script>
{% endblock %}
