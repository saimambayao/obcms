{% load static %}
{# Related Items List Partial - for HTMX swaps #}
<div id="related-items-list">
    {% if work_item.get_related_and_siblings %}
        <div class="space-y-2">
            {% for related in work_item.get_related_and_siblings %}
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors">
                    <div class="flex-1">
                        <div class="flex items-center space-x-2">
                            <span class="inline-flex items-center px-2 py-1 rounded-md text-xs font-medium
                                {% if related.work_type == 'project' %}bg-purple-100 text-purple-800
                                {% elif related.work_type == 'activity' %}bg-blue-100 text-blue-800
                                {% elif related.work_type == 'task' %}bg-emerald-100 text-emerald-800
                                {% else %}bg-gray-100 text-gray-800{% endif %}">
                                {{ related.get_work_type_display }}
                            </span>
                            <a href="{% url 'common:work_item_detail' related.pk %}"
                               class="text-sm font-medium text-gray-900 hover:text-blue-600">
                                {{ related.title }}
                            </a>
                        </div>
                        <div class="mt-1 text-xs text-gray-500">
                            Status: <span class="font-medium">{{ related.get_status_display }}</span>
                            â€¢ Priority: <span class="font-medium">{{ related.get_priority_display }}</span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2 ml-3">
                        {# View Button #}
                        <a href="{% url 'common:work_item_detail' related.pk %}"
                           class="text-gray-600 hover:text-blue-600 transition-colors"
                           title="View related item">
                            <i class="fas fa-eye"></i>
                        </a>
                        {# Edit Button #}
                        <a href="{% url 'common:work_item_edit' related.pk %}"
                           class="text-gray-600 hover:text-blue-600 transition-colors"
                           title="Edit related item">
                            <i class="fas fa-edit"></i>
                        </a>
                        {# Remove Link Button - Works for both manually linked items and siblings #}
                        <button type="button"
                                hx-post="{% url 'common:work_item_remove_related' work_item.pk related.pk %}"
                                hx-target="#related-items-list"
                                hx-swap="outerHTML"
                                hx-confirm="Are you sure you want to unlink this item? This won't delete the item, just remove the relationship."
                                class="text-gray-600 hover:text-red-600 transition-colors"
                                title="Remove link">
                            <i class="fas fa-unlink"></i>
                        </button>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-sm text-gray-500 italic py-2">No related items yet</p>
    {% endif %}
</div>
