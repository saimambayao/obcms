# Pilot User Management

Phase 7 introduces a dedicated service layer and management commands for managing pilot
accounts.

## Commands

### Create Individual User
```bash
python manage.py create_pilot_user \
  --username moh_planner_1 \
  --email planner1@moh.gov.ph \
  --organization MOH \
  --role planner \
  --first-name Maryam \
  --last-name Hassan
```

### Bulk Import
```bash
python manage.py import_pilot_users data/examples/pilot_users_template.csv --send-emails
```

Use `--dry-run` to validate CSV files without creating accounts.

### Assign Role to Existing User
```bash
python manage.py assign_role moh_planner_1 planner
```

## Roles
Roles are implemented using Django groups:
- `pilot_admin`
- `planner`
- `budget_officer`
- `me_officer`
- `viewer`

Permissions are automatically synchronized when roles are first used.

## Email Notifications
Welcome emails are dispatched asynchronously via Celery using
`organizations.tasks.send_pilot_welcome_email`. Disable email delivery with the
`--no-email` flag in `create_pilot_user`.

## Password Policy
- Random passwords generated by `PilotUserService.generate_password`
- Minimum length configured via `PILOT_DEFAULT_PASSWORD_LENGTH`
- Encourage users to change passwords upon first login

## Audit Logging
- All creations are logged via Django logging (see `settings/staging.py`)
- Organization memberships persist even if users change roles

Follow these steps to onboard pilot participants efficiently while preserving security.
